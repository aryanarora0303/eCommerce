{"openapi":"3.0.0","paths":{"/auth/register":{"post":{"operationId":"register","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterDto"}}}},"responses":{"201":{"description":""}},"tags":["Auth"]}},"/auth/login":{"post":{"operationId":"login","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"200":{"description":""}},"tags":["Auth"]}},"/auth/refresh":{"post":{"operationId":"refreshToken","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenDto"}}}},"responses":{"200":{"description":""}},"tags":["Auth"]}},"/auth/logout":{"post":{"operationId":"logout","parameters":[],"responses":{"200":{"description":""}},"tags":["Auth"]}},"/auth/profile":{"get":{"operationId":"getProfile","parameters":[],"responses":{"200":{"description":""}},"tags":["Auth"]}},"/health":{"get":{"description":"Check the health status of the API and database connection","operationId":"getHealth","parameters":[],"responses":{"200":{"description":"Health check successful","content":{"application/json":{"example":{"status":"ok","timestamp":"2025-07-03T03:14:37.541Z","uptime":14.477015208,"environment":"development","database":{"type":"SQLite","file":"ecommerce.db","status":"connected"},"version":"1.0.0"}}}}},"summary":"Health check","tags":["Health"]}},"/":{"get":{"description":"Get basic API information and welcome message","operationId":"getHello","parameters":[],"responses":{"200":{"description":"API information retrieved","content":{"application/json":{"example":{"message":"Welcome to the eCommerce API!","version":"1.0.0","documentation":"/api","endpoints":{"users":"/users","products":"/products","orders":"/orders","reviews":"/reviews","health":"/health"}}}}}},"summary":"API information","tags":["Health"]}},"/users":{"get":{"description":"Retrieve users with pagination, filtering, sorting, searching, and includes. Requires admin or moderator role.","operationId":"findAll","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination","schema":{"minimum":1,"default":1,"example":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Number of results per page","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Number of records to skip (overrides page calculation)","schema":{"minimum":0,"example":0,"type":"number"}},{"name":"sortBy","required":false,"in":"query","description":"Field to sort by","schema":{"example":"created_at","type":"string"}},{"name":"sortOrder","required":false,"in":"query","description":"Sort order","schema":{"default":"ASC","example":"ASC","type":"string","enum":["ASC","DESC"]}},{"name":"search","required":false,"in":"query","description":"Search term to filter results","schema":{"example":"laptop","type":"string"}},{"name":"include","required":false,"in":"query","description":"Related entities to include in the response (joins). Can be comma-separated string or array","schema":{"example":["user","product"],"type":"array","items":{"type":"array"}}},{"name":"email","required":false,"in":"query","description":"Filter by user email","schema":{"example":"john.doe@example.com","type":"string"}},{"name":"first_name","required":false,"in":"query","description":"Filter by first name","schema":{"example":"John","type":"string"}},{"name":"last_name","required":false,"in":"query","description":"Filter by last name","schema":{"example":"Doe","type":"string"}},{"name":"city","required":false,"in":"query","description":"Filter by city","schema":{"example":"Toronto","type":"string"}},{"name":"state","required":false,"in":"query","description":"Filter by state/province","schema":{"example":"Ontario","type":"string"}},{"name":"country","required":false,"in":"query","description":"Filter by country","schema":{"example":"Canada","type":"string"}},{"name":"created_after","required":false,"in":"query","description":"Filter users created after this date (ISO 8601 format)","schema":{"example":"2025-01-01","type":"string"}},{"name":"created_before","required":false,"in":"query","description":"Filter users created before this date (ISO 8601 format)","schema":{"example":"2025-12-31","type":"string"}}],"responses":{"200":{"description":"Users retrieved successfully","content":{"application/json":{"example":{"data":[{"user_id":1,"email":"john.doe@example.com","first_name":"John","last_name":"Doe","phone":"+1234567890","address":"123 Main St","city":"Toronto","state":"Ontario","zip_code":"M1M 1M1","country":"Canada","created_at":"2025-07-03T03:14:01.000Z","updated_at":"2025-07-03T03:14:01.000Z"}],"pagination":{"page":1,"limit":10,"total":1,"totalPages":1,"hasNext":false,"hasPrev":false}}}}},"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Get all users with advanced querying (Admin/Moderator only)","tags":["Users"]}},"/users/{id}":{"get":{"description":"Retrieve a specific user by their ID. Users can only access their own profile unless they are admin/moderator.","operationId":"findOne","parameters":[{"name":"id","required":true,"in":"path","description":"User ID","schema":{"example":1,"type":"string"}}],"responses":{"200":{"description":"User found","content":{"application/json":{"example":{"user_id":1,"email":"john.doe@example.com","first_name":"John","last_name":"Doe","phone":"+1234567890","address":"123 Main St","city":"Toronto","state":"Ontario","zip_code":"M1M 1M1","country":"Canada","created_at":"2025-07-03T03:14:01.000Z","updated_at":"2025-07-03T03:14:01.000Z"}}}},"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Cannot access other user's profile"},"404":{"description":"User not found"}},"security":[{"bearer":[]}],"summary":"Get user by ID","tags":["Users"]},"patch":{"description":"Update user information. Users can only update their own profile unless they are admin.","operationId":"update","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserDto"}}}},"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Cannot update other user's profile"}},"security":[{"bearer":[]}],"summary":"Update user","tags":["Users"]},"delete":{"description":"Delete a user account. Only admins can delete users.","operationId":"remove","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Admin access required"}},"security":[{"bearer":[]}],"summary":"Delete user (Admin only)","tags":["Users"]}},"/products":{"post":{"description":"Add a new product to the catalog. Requires admin or moderator role.","operationId":"create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateProductDto"}}}},"responses":{"201":{"description":"Product successfully created","content":{"application/json":{"example":{"product_id":1,"name":"iPhone 15 Pro","description":"Latest iPhone with advanced features","price":1299.99,"category":"Electronics","brand":"Apple","stock_quantity":10,"image_url":"https://example.com/iphone15pro.jpg","is_active":true,"created_at":"2025-07-03T03:14:08.000Z","updated_at":"2025-07-03T03:14:08.000Z"}}}},"400":{"description":"Invalid input data"},"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Create a new product (Admin/Moderator only)","tags":["Products"]},"get":{"description":"Retrieve products with pagination, filtering, sorting, searching, and includes. Supports price ranges, category filtering, brand filtering, stock level filtering, and more.","operationId":"findAll","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination","schema":{"minimum":1,"default":1,"example":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Number of results per page","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Number of records to skip (overrides page calculation)","schema":{"minimum":0,"example":0,"type":"number"}},{"name":"sortBy","required":false,"in":"query","description":"Field to sort by","schema":{"example":"created_at","type":"string"}},{"name":"sortOrder","required":false,"in":"query","description":"Sort order","schema":{"default":"ASC","example":"ASC","type":"string","enum":["ASC","DESC"]}},{"name":"search","required":false,"in":"query","description":"Search term to filter results","schema":{"example":"laptop","type":"string"}},{"name":"include","required":false,"in":"query","description":"Related entities to include in the response (joins). Can be comma-separated string or array","schema":{"example":["user","product"],"type":"array","items":{"type":"array"}}}],"responses":{"200":{"description":"Products retrieved successfully","content":{"application/json":{"example":{"data":[{"product_id":1,"name":"iPhone 15 Pro","description":"Latest iPhone with advanced features","price":1299.99,"category":"Electronics","brand":"Apple","stock_quantity":10,"image_url":"https://example.com/iphone15pro.jpg","is_active":true,"created_at":"2025-07-03T03:14:08.000Z","updated_at":"2025-07-03T03:14:08.000Z"}],"pagination":{"page":1,"limit":10,"total":1,"totalPages":1,"hasNext":false,"hasPrev":false}}}}}},"summary":"Get all products with advanced querying","tags":["Products"]}},"/products/category/{category}":{"get":{"operationId":"findByCategory","parameters":[{"name":"category","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["Products"]}},"/products/{id}":{"get":{"operationId":"findOne","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":""}},"tags":["Products"]},"patch":{"description":"Update product information. Requires admin or moderator role.","operationId":"update","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProductDto"}}}},"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Update product (Admin/Moderator only)","tags":["Products"]},"delete":{"description":"Delete a product from the catalog. Only admins can delete products.","operationId":"remove","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Admin access required"}},"security":[{"bearer":[]}],"summary":"Delete product (Admin only)","tags":["Products"]}},"/products/{id}/stock":{"patch":{"description":"Update product stock quantity. Requires admin or moderator role.","operationId":"updateStock","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Update product stock (Admin/Moderator only)","tags":["Products"]}},"/orders":{"post":{"description":"Create a new order with order items. Stock quantities will be automatically updated. Authenticated users can only create orders for themselves.","operationId":"create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateOrderDto"}}}},"responses":{"201":{"description":"Order successfully created","content":{"application/json":{"example":{"order_id":1,"user_id":1,"order_date":"2025-07-03T03:14:15.000Z","status":"pending","total_amount":2599.98,"shipping_address":"123 Main St, Toronto, ON M1M 1M1","payment_method":"Credit Card","tracking_number":null,"notes":"Please deliver after 6 PM","created_at":"2025-07-03T03:14:15.000Z","updated_at":"2025-07-03T03:14:15.000Z","user":{"user_id":1,"email":"john.doe@example.com","first_name":"John","last_name":"Doe"},"order_items":[{"order_item_id":1,"product_id":1,"quantity":2,"unit_price":1299.99,"total_price":2599.98,"product":{"product_id":1,"name":"iPhone 15 Pro","price":1299.99}}]}}}},"400":{"description":"Invalid input data or insufficient stock"},"401":{"description":"Unauthorized - Invalid or missing token"}},"security":[{"bearer":[]}],"summary":"Create a new order","tags":["Orders"]},"get":{"description":"Retrieve orders with pagination, filtering, sorting, searching, and includes. Users see only their own orders unless they are admin/moderator.","operationId":"findAll","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination","schema":{"minimum":1,"default":1,"example":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Number of results per page","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Number of records to skip (overrides page calculation)","schema":{"minimum":0,"example":0,"type":"number"}},{"name":"sortBy","required":false,"in":"query","description":"Field to sort by","schema":{"example":"created_at","type":"string"}},{"name":"sortOrder","required":false,"in":"query","description":"Sort order","schema":{"default":"ASC","example":"ASC","type":"string","enum":["ASC","DESC"]}},{"name":"search","required":false,"in":"query","description":"Search term to filter results","schema":{"example":"laptop","type":"string"}},{"name":"include","required":false,"in":"query","description":"Related entities to include in the response (joins). Can be comma-separated string or array","schema":{"example":["user","product"],"type":"array","items":{"type":"array"}}}],"responses":{"200":{"description":"Orders retrieved successfully","content":{"application/json":{"example":{"data":[{"order_id":1,"user_id":1,"order_date":"2025-07-03T03:14:15.000Z","status":"pending","total_amount":2599.98,"shipping_address":"123 Main St, Toronto, ON M1M 1M1","payment_method":"Credit Card","tracking_number":null,"notes":"Please deliver after 6 PM","created_at":"2025-07-03T03:14:15.000Z","updated_at":"2025-07-03T03:14:15.000Z","user":{"user_id":1,"email":"john.doe@example.com","first_name":"John","last_name":"Doe"},"order_items":[{"order_item_id":1,"product_id":1,"quantity":2,"unit_price":1299.99,"total_price":2599.98,"product":{"product_id":1,"name":"iPhone 15 Pro","price":1299.99,"category":"Electronics","brand":"Apple"}}]}],"pagination":{"page":1,"limit":10,"total":1,"totalPages":1,"hasNext":false,"hasPrev":false}}}}},"401":{"description":"Unauthorized - Invalid or missing token"}},"security":[{"bearer":[]}],"summary":"Get orders with advanced querying","tags":["Orders"]}},"/orders/{id}":{"get":{"description":"Retrieve a specific order. Users can only access their own orders unless they are admin/moderator.","operationId":"findOne","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Cannot access other user's orders"}},"security":[{"bearer":[]}],"summary":"Get order by ID","tags":["Orders"]},"patch":{"description":"Update order information. Users can only update their own orders unless they are admin/moderator.","operationId":"update","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateOrderDto"}}}},"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Cannot update other user's orders"}},"security":[{"bearer":[]}],"summary":"Update order","tags":["Orders"]},"delete":{"description":"Delete an order. Only admins can delete orders.","operationId":"remove","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Admin access required"}},"security":[{"bearer":[]}],"summary":"Delete order (Admin only)","tags":["Orders"]}},"/orders/user/{userId}":{"get":{"description":"Retrieve orders for a specific user. Users can only access their own orders unless they are admin/moderator.","operationId":"findByUser","parameters":[{"name":"userId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Cannot access other user's orders"}},"security":[{"bearer":[]}],"summary":"Get orders by user","tags":["Orders"]}},"/orders/{id}/status":{"patch":{"description":"Update order status. Only admin or moderator can change order status.","operationId":"updateStatus","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Insufficient permissions"}},"security":[{"bearer":[]}],"summary":"Update order status (Admin/Moderator only)","tags":["Orders"]}},"/reviews":{"post":{"description":"Creates a new product review with rating and optional comment. Users can only create reviews for themselves.","operationId":"create","parameters":[],"requestBody":{"required":true,"description":"Review data including product_id, rating, and optional title/comment","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateReviewDto"}}}},"responses":{"201":{"description":"Review successfully created","content":{"application/json":{"example":{"id":1,"user_id":1,"product_id":1,"rating":5,"title":"Great product!","comment":"This product exceeded my expectations.","is_verified_purchase":true,"helpful_votes":0,"created_at":"2024-01-01T00:00:00Z","updated_at":"2024-01-01T00:00:00Z"}}}},"400":{"description":"Invalid input data"},"401":{"description":"Unauthorized - Invalid or missing token"}},"security":[{"bearer":[]}],"summary":"Create a new review","tags":["Reviews"]},"get":{"description":"Retrieve reviews with support for pagination, filtering, sorting, and searching","operationId":"findAll","parameters":[{"name":"page","required":false,"in":"query","description":"Page number for pagination","schema":{"minimum":1,"default":1,"example":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Number of results per page","schema":{"minimum":1,"maximum":100,"default":10,"example":10,"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Number of records to skip (overrides page calculation)","schema":{"minimum":0,"example":0,"type":"number"}},{"name":"sortBy","required":false,"in":"query","description":"Field to sort by","schema":{"example":"created_at","type":"string"}},{"name":"sortOrder","required":false,"in":"query","description":"Sort order","schema":{"default":"ASC","example":"ASC","type":"string","enum":["ASC","DESC"]}},{"name":"search","required":false,"in":"query","description":"Search term to filter results","schema":{"example":"laptop","type":"string"}},{"name":"include","required":false,"in":"query","description":"Related entities to include in the response (joins). Can be comma-separated string or array","schema":{"example":["user","product"],"type":"array","items":{"type":"array"}}},{"name":"user_id","required":false,"in":"query","description":"Filter reviews by user ID","schema":{"example":1,"type":"number"}},{"name":"product_id","required":false,"in":"query","description":"Filter reviews by product ID","schema":{"example":1,"type":"number"}},{"name":"rating","required":false,"in":"query","description":"Filter reviews by exact rating","schema":{"minimum":1,"maximum":5,"example":5,"type":"number"}},{"name":"min_rating","required":false,"in":"query","description":"Filter reviews with rating greater than or equal to this value","schema":{"minimum":1,"maximum":5,"example":3,"type":"number"}},{"name":"max_rating","required":false,"in":"query","description":"Filter reviews with rating less than or equal to this value","schema":{"minimum":1,"maximum":5,"example":4,"type":"number"}},{"name":"is_verified_purchase","required":false,"in":"query","description":"Filter by verified purchase status","schema":{"example":true,"type":"boolean"}},{"name":"created_after","required":false,"in":"query","description":"Filter reviews created after this date (ISO 8601 format)","schema":{"example":"2024-01-01T00:00:00Z","type":"string"}},{"name":"created_before","required":false,"in":"query","description":"Filter reviews created before this date (ISO 8601 format)","schema":{"example":"2024-12-31T23:59:59Z","type":"string"}}],"responses":{"200":{"description":"Reviews retrieved successfully","content":{"application/json":{"example":{"data":[{"id":1,"user_id":1,"product_id":1,"rating":5,"title":"Great product!","comment":"This product exceeded my expectations.","is_verified_purchase":true,"helpful_votes":5,"created_at":"2024-01-01T00:00:00Z","updated_at":"2024-01-01T00:00:00Z","user":{"id":1,"first_name":"John","last_name":"Doe"},"product":{"id":1,"name":"Sample Product","price":99.99}}],"pagination":{"page":1,"limit":10,"total":1,"totalPages":1,"hasNext":false,"hasPrev":false}}}}}},"summary":"Get all reviews with advanced filtering","tags":["Reviews"]}},"/reviews/{id}":{"get":{"description":"Retrieve a specific review by its ID","operationId":"findOne","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID","schema":{"example":1,"type":"number"}}],"responses":{"200":{"description":"Review found","content":{"application/json":{"example":{"id":1,"user_id":1,"product_id":1,"rating":5,"title":"Great product!","comment":"This product exceeded my expectations.","is_verified_purchase":true,"helpful_votes":5,"created_at":"2024-01-01T00:00:00Z","updated_at":"2024-01-01T00:00:00Z"}}}},"404":{"description":"Review not found"}},"summary":"Get review by ID","tags":["Reviews"]},"patch":{"description":"Update an existing review with new rating, title, or comment. Users can only update their own reviews unless they are admin/moderator.","operationId":"update","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID","schema":{"example":1,"type":"number"}}],"requestBody":{"required":true,"description":"Updated review data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateReviewDto"}}}},"responses":{"200":{"description":"Review updated successfully","content":{"application/json":{"example":{"id":1,"user_id":1,"product_id":1,"rating":4,"title":"Updated title","comment":"Updated comment after longer use.","is_verified_purchase":true,"helpful_votes":5,"created_at":"2024-01-01T00:00:00Z","updated_at":"2024-01-02T00:00:00Z"}}}},"400":{"description":"Invalid input data"},"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Cannot update other user's reviews"},"404":{"description":"Review not found"}},"security":[{"bearer":[]}],"summary":"Update a review","tags":["Reviews"]},"delete":{"description":"Delete an existing review by ID. Users can only delete their own reviews unless they are admin/moderator.","operationId":"remove","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID","schema":{"example":1,"type":"number"}}],"responses":{"200":{"description":"Review deleted successfully","content":{"application/json":{"example":{"message":"Review deleted successfully"}}}},"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Cannot delete other user's reviews"},"404":{"description":"Review not found"}},"security":[{"bearer":[]}],"summary":"Delete a review","tags":["Reviews"]}},"/reviews/product/{productId}":{"get":{"description":"Retrieve all reviews for a given product ID","operationId":"findByProduct","parameters":[{"name":"productId","required":true,"in":"path","description":"Product ID","schema":{"example":1,"type":"number"}}],"responses":{"200":{"description":"Product reviews retrieved successfully","content":{"application/json":{"example":[{"id":1,"user_id":1,"product_id":1,"rating":5,"title":"Great product!","comment":"This product exceeded my expectations.","is_verified_purchase":true,"helpful_votes":5,"created_at":"2024-01-01T00:00:00Z","updated_at":"2024-01-01T00:00:00Z"}]}}}},"summary":"Get reviews for a specific product","tags":["Reviews"]}},"/reviews/product/{productId}/stats":{"get":{"description":"Get aggregated rating statistics including average rating, total reviews, and rating distribution","operationId":"getProductRatingStats","parameters":[{"name":"productId","required":true,"in":"path","description":"Product ID","schema":{"example":1,"type":"number"}}],"responses":{"200":{"description":"Rating statistics retrieved successfully","content":{"application/json":{"example":{"average_rating":4.5,"total_reviews":10,"rating_distribution":{"1":0,"2":0,"3":1,"4":3,"5":6}}}}}},"summary":"Get rating statistics for a product","tags":["Reviews"]}},"/reviews/user/{userId}":{"get":{"description":"Retrieve all reviews created by a given user ID. Users can only access their own reviews unless they are admin/moderator.","operationId":"findByUser","parameters":[{"name":"userId","required":true,"in":"path","description":"User ID","schema":{"example":1,"type":"number"}}],"responses":{"200":{"description":"User reviews retrieved successfully","content":{"application/json":{"example":[{"id":1,"user_id":1,"product_id":1,"rating":5,"title":"Great product!","comment":"This product exceeded my expectations.","is_verified_purchase":true,"helpful_votes":5,"created_at":"2024-01-01T00:00:00Z","updated_at":"2024-01-01T00:00:00Z"}]}}},"401":{"description":"Unauthorized - Invalid or missing token"},"403":{"description":"Forbidden - Cannot access other user's reviews"}},"security":[{"bearer":[]}],"summary":"Get reviews by a specific user","tags":["Reviews"]}},"/reviews/{id}/helpful":{"patch":{"description":"Increment the helpful votes count for a review","operationId":"incrementHelpfulVotes","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID","schema":{"example":1,"type":"number"}}],"responses":{"200":{"description":"Helpful vote added successfully","content":{"application/json":{"example":{"id":1,"helpful_votes":6,"message":"Helpful vote added successfully"}}}},"404":{"description":"Review not found"}},"summary":"Mark review as helpful","tags":["Reviews"]}}},"info":{"title":"eCommerce API","description":"Comprehensive eCommerce API with advanced querying capabilities including pagination, filtering, sorting, searching, and joins","version":"1.0.0","contact":{"name":"API Support","url":"https://github.com/yourusername/ecommerce-api","email":"support@yourcompany.com"},"license":{"name":"MIT","url":"https://opensource.org/licenses/MIT"}},"tags":[{"name":"Users","description":"User management operations"},{"name":"Products","description":"Product catalog operations"},{"name":"Orders","description":"Order management operations"},{"name":"Reviews","description":"Product review operations"},{"name":"Health","description":"Health check operations"}],"servers":[{"url":"http://localhost:3151","description":"Development server"}],"components":{"securitySchemes":{"bearer":{"scheme":"bearer","bearerFormat":"JWT","type":"http"}},"schemas":{"RegisterDto":{"type":"object","properties":{}},"LoginDto":{"type":"object","properties":{}},"RefreshTokenDto":{"type":"object","properties":{}},"UpdateUserDto":{"type":"object","properties":{"email":{"type":"string","example":"jane.doe@example.com","description":"User's email address"},"password":{"type":"string","example":"newsecurepassword456","description":"User's new password (minimum 6 characters)","minLength":6,"maxLength":255},"first_name":{"type":"string","example":"Jane","description":"User's first name","maxLength":100},"last_name":{"type":"string","example":"Smith","description":"User's last name","maxLength":100},"phone":{"type":"string","example":"+1987654321","description":"User's phone number","maxLength":20},"address":{"type":"string","example":"456 Oak St","description":"User's street address"},"city":{"type":"string","example":"Vancouver","description":"User's city","maxLength":100},"state":{"type":"string","example":"British Columbia","description":"User's state/province","maxLength":100},"zip_code":{"type":"string","example":"V6B 1A1","description":"User's postal/zip code","maxLength":20},"country":{"type":"string","example":"Canada","description":"User's country","maxLength":100}}},"CreateProductDto":{"type":"object","properties":{"name":{"type":"string","example":"iPhone 15 Pro","description":"Product name","maxLength":255},"description":{"type":"string","example":"Latest iPhone with A17 Pro chip, titanium design, and pro camera system","description":"Detailed product description"},"price":{"type":"number","example":1299.99,"description":"Product price in CAD","minimum":0},"category":{"type":"string","example":"Electronics","description":"Product category","maxLength":100},"brand":{"type":"string","example":"Apple","description":"Product brand","maxLength":100},"stock_quantity":{"type":"number","example":50,"description":"Available stock quantity","minimum":0},"image_url":{"type":"string","example":"https://example.com/images/iphone15pro.jpg","description":"Product image URL","maxLength":500},"is_active":{"type":"boolean","example":true,"description":"Whether the product is active/available for sale","default":true}},"required":["name","price","category"]},"UpdateProductDto":{"type":"object","properties":{"name":{"type":"string","example":"iPhone 15 Pro Max","description":"Product name","maxLength":255},"description":{"type":"string","example":"Latest iPhone with A17 Pro chip, titanium design, and pro camera system with 5x zoom","description":"Detailed product description"},"price":{"type":"number","example":1499.99,"description":"Product price in CAD","minimum":0},"category":{"type":"string","example":"Electronics","description":"Product category","maxLength":100},"brand":{"type":"string","example":"Apple","description":"Product brand","maxLength":100},"stock_quantity":{"type":"number","example":25,"description":"Available stock quantity","minimum":0},"image_url":{"type":"string","example":"https://example.com/images/iphone15promax.jpg","description":"Product image URL","maxLength":500},"is_active":{"type":"boolean","example":true,"description":"Whether the product is active/available for sale"}}},"CreateOrderItemDto":{"type":"object","properties":{"product_id":{"type":"number","description":"ID of the product being ordered","example":1},"quantity":{"type":"number","description":"Quantity of the product","example":2,"minimum":1},"unit_price":{"type":"number","description":"Unit price of the product (up to 2 decimal places)","example":99.99,"minimum":0}},"required":["product_id","quantity","unit_price"]},"CreateOrderDto":{"type":"object","properties":{"user_id":{"type":"number","description":"ID of the user placing the order","example":1},"shipping_address":{"type":"string","description":"Complete shipping address for the order","example":"123 Main St, Toronto, ON M1M 1M1, Canada"},"payment_method":{"type":"string","description":"Payment method used for the order","example":"Credit Card","enum":["Credit Card","Debit Card","PayPal","Cash","Bank Transfer"]},"notes":{"type":"string","description":"Additional notes or instructions for the order","example":"Please deliver after 6 PM"},"order_items":{"description":"Array of items being ordered","example":[{"product_id":1,"quantity":2,"unit_price":1299.99},{"product_id":2,"quantity":1,"unit_price":999.99}],"type":"array","items":{"$ref":"#/components/schemas/CreateOrderItemDto"}}},"required":["user_id","shipping_address","payment_method","order_items"]},"UpdateOrderDto":{"type":"object","properties":{}},"CreateReviewDto":{"type":"object","properties":{"user_id":{"type":"number","description":"ID of the user creating the review","example":1},"product_id":{"type":"number","description":"ID of the product being reviewed","example":1},"rating":{"type":"number","description":"Rating given to the product (1-5 stars)","example":5,"minimum":1,"maximum":5},"title":{"type":"string","description":"Optional title for the review","example":"Great product!","maxLength":255},"comment":{"type":"string","description":"Detailed comment about the product","example":"This product exceeded my expectations. The quality is excellent and delivery was fast."},"is_verified_purchase":{"type":"boolean","description":"Whether this review is from a verified purchase","example":true}},"required":["user_id","product_id","rating"]},"UpdateReviewDto":{"type":"object","properties":{"rating":{"type":"number","description":"Updated rating for the product (1-5 stars)","example":4,"minimum":1,"maximum":5},"title":{"type":"string","description":"Updated title for the review","example":"Updated title","maxLength":255},"comment":{"type":"string","description":"Updated comment about the product","example":"Updated my review after using it for a longer time."},"is_verified_purchase":{"type":"boolean","description":"Updated verified purchase status","example":false},"helpful_votes":{"type":"number","description":"Number of helpful votes received","example":10,"minimum":0}}}}}}